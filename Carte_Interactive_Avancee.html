<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.4.1.min.js"></script>                <div id="76b1c844-c598-46e6-a5c1-adafa9cfdc60" class="plotly-graph-div" style="height:750px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("76b1c844-c598-46e6-a5c1-adafa9cfdc60")) {                    Plotly.newPlot(                        "76b1c844-c598-46e6-a5c1-adafa9cfdc60",                        [{"coloraxis":"coloraxis","featureidkey":"properties.code","geo":"geo","geojson":"https://france-geojson.gregoiredavid.fr/repo/departements.geojson","hovertemplate":"<b>%{hovertext}</b><br><br>DÃ©partement=%{location}<br>Nombre de pharmacies=%{z}<extra></extra>","hovertext":["AIN","AISNE","ALLIER","ALPES DE HAUTE PROVENCE","HAUTES ALPES","ALPES MARITIMES","ARDECHE","ARDENNES","ARIEGE","AUBE","AUDE","AVEYRON","BOUCHES DU RHONE","CALVADOS","CANTAL","CHARENTE","CHARENTE MARITIME","CHER","CORREZE","COTE D OR","COTES D ARMOR","CREUSE","DORDOGNE","DOUBS","DROME","EURE","EURE ET LOIR","FINISTERE","CORSE DU SUD","HAUTE CORSE","GARD","HAUTE GARONNE","GERS","GIRONDE","HERAULT","ILLE ET VILAINE","INDRE","INDRE ET LOIRE","ISERE","JURA","LANDES","LOIR ET CHER","LOIRE","HAUTE LOIRE","LOIRE ATLANTIQUE","LOIRET","LOT","LOT ET GARONNE","LOZERE","MAINE ET LOIRE","MANCHE","MARNE","HAUTE MARNE","MAYENNE","MEURTHE ET MOSELLE","MEUSE","MORBIHAN","MOSELLE","NIEVRE","NORD","OISE","ORNE","PAS DE CALAIS","PUY DE DOME","PYRENEES ATLANTIQUES","HAUTES PYRENEES","PYRENEES ORIENTALES","BAS RHIN","HAUT RHIN","RHONE","HAUTE SAONE","SAONE ET LOIRE","SARTHE","SAVOIE","HAUTE SAVOIE","PARIS","SEINE MARITIME","SEINE ET MARNE","YVELINES","DEUX SEVRES","SOMME","TARN","TARN ET GARONNE","VAR","VAUCLUSE","VENDEE","VIENNE","HAUTE VIENNE","VOSGES","YONNE","TERRITOIRE DE BELFORT","ESSONNE","HAUTS DE SEINE","SEINE SAINT DENIS","VAL DE MARNE","VAL D OISE","GUADELOUPE","MARTINIQUE","GUYANE","LA REUNION","SAINT PIERRE ET MIQUELON","MAYOTTE"],"locations":["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","21","22","23","24","25","26","27","28","29","2A","2B","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","9A","9B","9C","9D","9E","9F"],"name":"","type":"choropleth","z":[157,164,124,59,54,428,96,102,48,84,135,104,729,203,63,117,213,98,91,161,178,54,138,173,146,139,103,276,58,69,234,394,62,510,381,287,79,187,364,85,130,96,208,78,387,172,62,116,34,227,133,176,59,80,251,56,227,256,73,862,208,82,475,222,237,85,169,273,186,530,82,172,149,143,219,865,335,344,366,118,183,124,70,358,192,207,138,144,125,96,47,322,446,390,371,316,159,135,51,244,1,27]}],                        {"coloraxis":{"colorbar":{"title":{"text":"Nombre de pharmacies"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]]},"geo":{"center":{},"domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"fitbounds":"locations","visible":false},"height":750,"legend":{"tracegroupgap":0},"margin":{"b":0,"l":0,"r":0,"t":60},"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Carte interactive â suivi des pharmacies contactÃ©es"}},                        {"responsive": true}                    )                };                            </script>        </div>

<script>
let contactData = JSON.parse(localStorage.getItem('contactData') || '{}');

function formatHoverText(name, code, total) {
    const contact = contactData[code]?.count || 0;
    return `${name} (${code})\n${contact} / ${total} contactÃ©${contact > 1 ? 's' : ''}`;
}

function updateVisuals() {
    const paths = document.querySelectorAll('g.trace.below path');
    let totalContacted = 0;
    let totalPharmacies = 0;

    paths.forEach(path => {
        const code = path.__data__.location;
        const dataItem = contactData[code];
        const total = parseInt(path.__data__.z);
        totalPharmacies += total;
        const count = dataItem?.count || 0;
        totalContacted += count;
        const ratio = count / total;

        // Coloration manuelle
        if (ratio === 0) path.style.fill = "#cccccc";
        else if (ratio < 0.25) path.style.fill = "#e74c3c";
        else if (ratio < 0.5) path.style.fill = "#f39c12";
        else if (ratio < 0.75) path.style.fill = "#f1c40f";
        else path.style.fill = "#2ecc71";

        path.setAttribute("title", formatHoverText(path.__data__.hovertext, code, total));
    });

    document.getElementById("global-progress").innerText =
        `ð Progression : ${totalContacted} pharmacies contactÃ©es sur ${totalPharmacies}`;
}

document.addEventListener("DOMContentLoaded", () => {
    const panel = document.createElement("div");
    panel.id = "global-progress";
    panel.style.position = "fixed";
    panel.style.top = "10px";
    panel.style.left = "50%";
    panel.style.transform = "translateX(-50%)";
    panel.style.background = "#ffffffdd";
    panel.style.padding = "10px 20px";
    panel.style.border = "1px solid #ccc";
    panel.style.borderRadius = "10px";
    panel.style.zIndex = "9999";
    panel.style.fontFamily = "sans-serif";
    panel.style.fontSize = "16px";
    document.body.appendChild(panel);

    updateVisuals();

    document.addEventListener("click", e => {
        const path = e.target.closest('path');
        if (!path || !path.__data__?.location) return;
        const code = path.__data__.location;
        const nom = path.__data__.hovertext;
        const total = parseInt(path.__data__.z);

        const current = contactData[code]?.count || 0;
        const saisie = prompt(`ð ${nom}\n${total} pharmacies\nCombien contactÃ©es ?`, current);
        const valeur = parseInt(saisie);
        if (!isNaN(valeur) && valeur >= 0 && valeur <= total) {
            contactData[code] = { count: valeur };
            localStorage.setItem("contactData", JSON.stringify(contactData));
            updateVisuals();
        }
    });

    document.querySelectorAll("path").forEach(p => {
        p.addEventListener("mouseover", function() {
            const code = this.__data__.location;
            const nom = this.__data__.hovertext;
            const total = parseInt(this.__data__.z);
            this.setAttribute("title", formatHoverText(nom, code, total));
        });
    });
});
</script>

</body>
</html>